# Hints â€” Scan

## Hillis-Steele (inclusive)
```cuda
for (int stride = 1; stride < blockDim.x; stride *= 2) {
    int out_buf = 1 - in_buf;
    if (tid >= stride)
        buf[out_buf][tid] = buf[in_buf][tid] + buf[in_buf][tid - stride];
    else
        buf[out_buf][tid] = buf[in_buf][tid];
    __syncthreads();
    in_buf = out_buf;
}
```

## Blelloch up-sweep
```cuda
for (int stride = 1; stride < blockDim.x; stride *= 2) {
    __syncthreads();
    int idx = (tid + 1) * stride * 2 - 1;
    if (idx < blockDim.x)
        sdata[idx] += sdata[idx - stride];
}
```

## Blelloch down-sweep
```cuda
for (int stride = blockDim.x / 4; stride > 0; stride /= 2) {
    __syncthreads();
    int idx = (tid + 1) * stride * 2 - 1;
    if (idx + stride < blockDim.x) {
        float temp = sdata[idx];  // left child
        sdata[idx] = sdata[idx + stride];  // left = parent
        sdata[idx + stride] += temp;  // right = parent + left
    }
}
```
Note: Blelloch requires N to be a power of 2. Pad with zeros if not.
