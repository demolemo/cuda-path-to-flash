# Hints â€” Shared Memory Reduction

## Naive version
```cuda
for (int stride = 1; stride <= blockDim.x / 2; stride *= 2) {
    if (tid % (2 * stride) == 0)
        sdata[tid] += sdata[tid + stride];
    __syncthreads();
}
```

## Improved version
```cuda
for (int stride = blockDim.x / 2; stride > 0; stride >>= 1) {
    if (tid < stride)
        sdata[tid] += sdata[tid + stride];
    __syncthreads();
}
```

## Coarsened version
```cuda
float sum = 0.0f;
for (int i = 0; i < COARSEN_FACTOR; i++) {
    int idx = gid + i * blockDim.x;
    if (idx < n) sum += input[idx];
}
sdata[tid] = sum;
```
Then same tree reduction as improved.
